How to setup VOIP Caller ID using ncidsip

The server, ncidd, always checks for a CID message, so if you have a
standard telephone line modem configured, and you have at least one VOIP
telephone line, all you need to do is to configure and start ncidsip.
The server will handle both easily.

If you are only using VOIP and do not want to use a modem, you
need to configure ncidd by changing one line in ncidd.conf.

    Change the line: # set noserial = 1
                 To: set noserial = 1

This tells ncidd to run without a serial device or modem connected.
Once you change ncidd.conf, you must start/restart ncidd to read it.

Next you need to determine if you can receive SIP data packs.
As root run: ncidsip --test

If ncidsip terminates you should be able to see why and fix it.
(ncidsip --help will give a detailed usage message)

Sometimes it picks the wrong default interface, so if it needs etho:
As root run: ncidsip --testsip -i eth0

If you need to see what interfaces are present to use one with the
--interface or -i option: ncidsip --listdevs

If you do not see any SIP packets, change to port 10000 and try again:
As root run: ncidsip --test --sip :10000

You should see something like:

  NCIDsip Version 0.2.0
  Connecting to NCID server on localhost:3333
  Connected: 200 Network CallerID Server Version 0.64
  CIDLOG: *DATE*06022006*TIME*0908*LINE*1792*NMBR*13215551530*MESG*NONE*NAME*EAR & BAL*
  CIDLOG: *DATE*06022006*TIME*1749*LINE*1792*NMBR*17325556730*MESG*NONE*NAME*Cynthia at home*
  Opening 'eth0'
  filter: port 5061 and udp

Then about every 20 seconds you should see something like:

  SIP/2.0 200 OK
  Via: SIP/2.0/UDP 70.119.157.214:5061;branch=z9hG4bK-22b185d1
  From: 321-249-7722 <sip:13215551212@atlas2.atlas.vonage.net:5061>;tag=46f26356c0a3394bo0
  To: 321-249-7722 <sip:13215551212@atlas2.atlas.vonage.net:5061>
  Call-ID: fa72d1c2-ead1bdcf@70.119.157.214
  CSeq: 86785 REGISTER
  Contact: 321-555-1212 <sip:13215551212@70.119.157.214:5061>;expires=20
  Content-Length: 0

If you do not get the above, you may need to specify a address and or port
for ncidsip to listen for the SIP Invite.  You cannot continue unless you
get the above.

Call yourself.  If you do not get a caller id message sent to the
server, you should get a error message saying what is wrong.  This
has been tested with Vonage and so may need tweaking.

Be sure to hang up at the second ring, and terminate ncidsip before too
many of the above messages are displayed.

If you had Caller ID sent to a client, setup is complete.  You can then
restart ncidsip without any options so it will not display anything.  You
can also set it up to start at boot, along with ncidd.

If ncidsip did not work, you should have enough information to ask for help.
